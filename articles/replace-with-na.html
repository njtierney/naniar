<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Replacing values with NA • naniar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Replacing values with NA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">naniar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/naniar.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/naniar-visualisation.html">Gallery</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/replace-with-na.html">Replace with NA</a></li>
    <li><a class="dropdown-item" href="../articles/special-missing-values.html">Special Missings</a></li>
    <li><a class="dropdown-item" href="../articles/exploring-imputed-values.html">Exploring Imputations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.njtierney.com/post/2024/03/04/naniar-version-1-1-0-prince-caspian/">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.njtierney.com/post/2023/02/07/naniar-version-1/">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/njtierney/naniar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Replacing values with NA</h1>
                        <h4 data-toc-skip class="author">Nicholas
Tierney</h4>
            
            <h4 data-toc-skip class="date">2025-04-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/njtierney/naniar/blob/main/vignettes/replace-with-na.Rmd" class="external-link"><code>vignettes/replace-with-na.Rmd</code></a></small>
      <div class="d-none name"><code>replace-with-na.Rmd</code></div>
    </div>

    
    
<p>When dealing with missing values, you might want to replace values
with a missing values (<code>NA</code>). This is useful in cases when
you know the origin of the data and can be certain which values should
be missing. For example, you might know that all values of “N/A”, “N A”,
and “Not Available”, or -99, or -1 are supposed to be missing.</p>
<p><code>naniar</code> provides functions to specifically work on this
type of problem using the function <code><a href="../reference/replace_with_na.html">replace_with_na()</a></code>. This
function is the compliment to <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">tidyr::replace_na()</a></code>, which
replaces an NA value with a specified value, whereas
<code><a href="../reference/replace_with_na.html">naniar::replace_with_na()</a></code> replaces a value with an NA:</p>
<ul>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">tidyr::replace_na()</a></code>: Missing values turns into a value
(NA –&gt; -99)</li>
<li>
<code><a href="../reference/replace_with_na.html">naniar::replace_with_na()</a></code>: Value becomes a missing
value (-99 –&gt; NA)</li>
</ul>
<p>In this vignette, we describe some simple use cases for these
functions and describe how they work.</p>
<div class="section level2">
<h2 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p>First, we introduce a small fictional dataset, <code>df</code>, which
contains some common features of a dataset with the sorts of missing
values we might encounter. This includes multiple specifications of
missing values, such as “N/A”, “N A”, and “Not Available”. And also some
common numeric codes, like -98, -99, and -1.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">name</span>,           <span class="op">~</span><span class="va">x</span>,  <span class="op">~</span><span class="va">y</span>,              <span class="op">~</span><span class="va">z</span>,  </span>
<span>  <span class="st">"N/A"</span>,           <span class="fl">1</span>,   <span class="st">"N/A"</span>,           <span class="op">-</span><span class="fl">100</span>, </span>
<span>  <span class="st">"N A"</span>,           <span class="fl">3</span>,   <span class="st">"NOt available"</span>, <span class="op">-</span><span class="fl">99</span>,</span>
<span>  <span class="st">"N / A"</span>,         <span class="cn">NA</span>,  <span class="st">"29"</span>,              <span class="op">-</span><span class="fl">98</span>,</span>
<span>  <span class="st">"Not Available"</span>, <span class="op">-</span><span class="fl">99</span>, <span class="st">"25"</span>,              <span class="op">-</span><span class="fl">101</span>,</span>
<span>  <span class="st">"John Smith"</span>,    <span class="op">-</span><span class="fl">98</span>, <span class="st">"28"</span>,              <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-replace_with_na">Using <code>replace_with_na</code><a class="anchor" aria-label="anchor" href="#using-replace_with_na"></a>
</h3>
<p>What if we want to replace the value -99 in the <code>x</code> column
with a missing value?</p>
<p>First, let’s load <code>naniar</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/njtierney/naniar" class="external-link">naniar</a></span><span class="op">)</span></span></code></pre></div>
<p>Now, we specify the fact that we want to replace -99 with a missing
value. To do so we use the <code>replace</code> argument, and specify a
named list, which contains the names of the variable and the value it
would take to replace with <code>NA</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/replace_with_na.html">replace_with_na</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available   -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>And say we want to replace -98 as well?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na.html">replace_with_na</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99</span>, <span class="op">-</span><span class="fl">98</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available   -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith       <span style="color: #BB0000;">NA</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>And then what if we want to replace -99 and -98 in all the numeric
columns, x and z?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na.html">replace_with_na</a></span><span class="op">(</span>replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99</span>,<span class="op">-</span><span class="fl">98</span><span class="op">)</span>,</span>
<span>                             z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99</span>, <span class="op">-</span><span class="fl">98</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith       <span style="color: #BB0000;">NA</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>Using <code><a href="../reference/replace_with_na.html">replace_with_na()</a></code> works well when we know the
exact value to be replaced, and for which variables we want to replace,
providing there are not many variables. But what do you do when you’ve
got many variables you want to observe?</p>
</div>
<div class="section level3">
<h3 id="extending-replace_with_na">Extending <code>replace_with_na</code><a class="anchor" aria-label="anchor" href="#extending-replace_with_na"></a>
</h3>
<p>Sometimes you have many of the same value that you want to replace.
For example, -99 and -98 above, and also the variants of “NA”, such as
“N/A”, and “N / A”, and “Not Available”. You might also have certain
variables that you want to be affected by these rules, or you might have
more complex rules, like, “only affect variables that are numeric, or
character, with this rule”.</p>
<p>To account for these cases we have borrowed from <a href="https://dplyr.tidyverse.org/reference/scoped.html" class="external-link"><code>dplyr</code>’s
scoped variants</a> and created the functions:</p>
<ul>
<li>
<code><a href="../reference/replace_with_na_all.html">replace_with_na_all()</a></code> Replaces NA for all
variables.</li>
<li>
<code><a href="../reference/replace_with_na_at.html">replace_with_na_at()</a></code> Replaces NA on a subset of
variables specified with character quotes (e.g., c(“var1”,
“var2”)).</li>
<li>
<code><a href="../reference/replace_with_na_if.html">replace_with_na_if()</a></code> Replaces NA based on applying an
operation on the subset of variables for which a predicate function
(is.numeric, is.character, etc) returns TRUE.</li>
</ul>
<p>Below we will now consider some very simple examples of the use of
these functions, so that you can better understand how to use them.</p>
</div>
<div class="section level3">
<h3 id="using-replace_with_na_all">Using <code>replace_with_na_all</code><a class="anchor" aria-label="anchor" href="#using-replace_with_na_all"></a>
</h3>
<p>Use <code><a href="../reference/replace_with_na_all.html">replace_with_na_all()</a></code> when you want to replace ALL
values that meet a condition across an entire dataset. The syntax here
is a little different, and follows the rules for rlang’s expression of
simple functions. This means that the function starts with
<code>~</code>, and when referencing a variable, you use
<code>.x</code>.</p>
<p>For example, if we want to replace all cases of -99 in our dataset,
we write:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/replace_with_na_all.html">replace_with_na_all</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">==</span> <span class="op">-</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>Likewise, if you have a set of (annoying) repeating strings like
various spellings of “NA”, then I suggest you first lay out all the
offending cases:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># write out all the offending strings</span></span>
<span><span class="va">na_strings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"N A"</span>, <span class="st">"N / A"</span>, <span class="st">"N/A"</span>, <span class="st">"N/ A"</span>, <span class="st">"Not Available"</span>, <span class="st">"NOt available"</span><span class="op">)</span></span></code></pre></div>
<p>Then you write <code>~.x %in% na_strings</code> - which reads as
“does this value occur in the list of NA strings”.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na_all.html">replace_with_na_all</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">na_strings</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name           x y         z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>             1 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>             3 <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> 29      -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>           -<span style="color: #BB0000;">99</span> 25     -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith   -<span style="color: #BB0000;">98</span> 28       -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>You can also use the built-in strings and numbers in naniar:</p>
<ul>
<li><code>common_na_numbers</code></li>
<li><code>common_na_strings</code></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">common_na_numbers</span></span>
<span><span class="co">#&gt; [1]    -9   -99  -999 -9999  9999    66    77    88</span></span>
<span><span class="va">common_na_strings</span></span>
<span><span class="co">#&gt;  [1] "missing" "NA"      "N A"     "N/A"     "#N/A"    "NA "     " NA"    </span></span>
<span><span class="co">#&gt;  [8] "N /A"    "N / A"   " N / A"  "N / A "  "na"      "n a"     "n/a"    </span></span>
<span><span class="co">#&gt; [15] "na "     " na"     "n /a"    "n / a"   " a / a"  "n / a "  "NULL"   </span></span>
<span><span class="co">#&gt; [22] "null"    ""        "\\?"     "\\*"     "\\."</span></span></code></pre></div>
<p>And you can replace values matching those strings or numbers like
so:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na_all.html">replace_with_na_all</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">common_na_strings</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>                1 <span style="color: #BB0000;">NA</span>             -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>                3 NOt available   -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available   -<span style="color: #BB0000;">99</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="replace_with_na_at">
<code>replace_with_na_at</code><a class="anchor" aria-label="anchor" href="#replace_with_na_at"></a>
</h4>
<p>This is similar to <code>_all</code>, but instead in this case you
can specify the variables that you want affected by the rule that you
state. This is useful in cases where you want to specify a rule that
only affects a selected number of variables.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/replace_with_na_at.html">replace_with_na_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"z"</span><span class="op">)</span>,</span>
<span>                     condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">==</span> <span class="op">-</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>Although you can achieve this with regular
<code><a href="../reference/replace_with_na.html">replace_with_na()</a></code>, it is more concise to use,
<code><a href="../reference/replace_with_na_at.html">replace_with_na_at()</a></code>. Additionally, you can specify rules
as function, for example, make a value NA if the exponent of that number
is less than 1:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/replace_with_na_at.html">replace_with_na_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"z"</span><span class="op">)</span>,</span>
<span>                     condition <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A              <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith       <span style="color: #BB0000;">NA</span> 28               <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="replace_with_na_if">
<code>replace_with_na_if</code><a class="anchor" aria-label="anchor" href="#replace_with_na_if"></a>
</h4>
<p>There may be some cases where you can identify variables based on
some test - <code><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character()</a></code> - are they character variables?
<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric()</a></code> - Are they numeric or double? and a given
value inside that type of data. For example,</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na_if.html">replace_with_na_if</a></span><span class="op">(</span>.predicate <span class="op">=</span> <span class="va">is.character</span>,</span>
<span>                     condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="st">"N/A"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>                1 <span style="color: #BB0000;">NA</span>             -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available   -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available   -<span style="color: #BB0000;">99</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span>
<span></span>
<span><span class="co"># or</span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_with_na_if.html">replace_with_na_if</a></span><span class="op">(</span>.predicate <span class="op">=</span> <span class="va">is.character</span>,</span>
<span>                     condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">na_strings</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name           x y         z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>             1 <span style="color: #BB0000;">NA</span>     -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>             3 <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> 29      -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>           -<span style="color: #BB0000;">99</span> 25     -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith   -<span style="color: #BB0000;">98</span> 28       -<span style="color: #BB0000;">1</span></span></span></code></pre></div>
<p>This means that you are able to apply a rule to many variables that
meet a pre-specified condition. This can be of particular use if you
have many variables and don’t want to list them all, and also if you
know that there is a particular problem for variables of a particular
class.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="notes-on-alternative-ways-to-handle-replacing-with-nas">Notes on alternative ways to handle replacing with NAs<a class="anchor" aria-label="anchor" href="#notes-on-alternative-ways-to-handle-replacing-with-nas"></a>
</h2>
<p>There are some alternative ways to handle replacing values with NA in
the tidyverse, <code>na_if</code> and using <code>readr</code>. These
are ultimately not as expressive as the <code><a href="../reference/replace_with_na.html">replace_with_na()</a></code>
functions, but they are very useful if you only have one kind of value
to replace with a missing, and if you know what the missing values are
upon reading in the data.</p>
<p><strong><code><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">dplyr::na_if</a></code></strong></p>
<p>This function allows you to replace exact values - similar to
<code><a href="../reference/replace_with_na.html">replace_with_na()</a></code>, but only for one single column in a data
frame. Here is how you would use it in our examples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># instead of:</span></span>
<span><span class="va">df_1</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/replace_with_na_all.html">replace_with_na_all</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">==</span> <span class="op">-</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">df_1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x y                 z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1 N/A            -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3 NOt available    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span> 29              -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span> 25             -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span> 28               -<span style="color: #BB0000;">1</span></span></span>
<span></span>
<span><span class="va">df_2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">99</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">z</span>, <span class="op">-</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   name              x     y     z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> N/A               1  -<span style="color: #BB0000;">100</span>  -<span style="color: #BB0000;">100</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N A               3    <span style="color: #BB0000;">NA</span>   -<span style="color: #BB0000;">99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> N / A            <span style="color: #BB0000;">NA</span>   -<span style="color: #BB0000;">98</span>   -<span style="color: #BB0000;">98</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Not Available    <span style="color: #BB0000;">NA</span>  -<span style="color: #BB0000;">101</span>  -<span style="color: #BB0000;">101</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> John Smith      -<span style="color: #BB0000;">98</span>    -<span style="color: #BB0000;">1</span>    -<span style="color: #BB0000;">1</span></span></span>
<span></span>
<span><span class="co"># are they the same?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">df_1</span>, <span class="va">df_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component \"y\": Modes: character, numeric"                       </span></span>
<span><span class="co">#&gt; [2] "Component \"y\": target is character, current is numeric"         </span></span>
<span><span class="co">#&gt; [3] "Component \"z\": 'is.NA' value mismatch: 0 in current 1 in target"</span></span></code></pre></div>
<p>Note, however, that <code><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if()</a></code> can only take arguments of
length one. This means that it cannot capture other statements like</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">na_strings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"N A"</span>, <span class="st">"N / A"</span>, <span class="st">"N/A"</span>, <span class="st">"N/ A"</span>, <span class="st">"Not Available"</span>, <span class="st">"NOt available"</span><span class="op">)</span></span>
<span><span class="va">df_3</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/replace_with_na_all.html">replace_with_na_all</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">na_strings</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Not run:</span></span>
<span><span class="va">df_4</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, y <span class="op">=</span> <span class="va">na_strings</span><span class="op">)</span></span>
<span><span class="co"># Error in check_length(y, x, fmt_args("y"), glue("same as {fmt_args(~x)}")) : </span></span>
<span>  <span class="co"># argument "y" is missing, with no default</span></span></code></pre></div>
<p>It also cannot handle more complex equations, where you want to refer
to values in other columns, or values less than or greater than another
value.</p>
<p><strong>catch NAs with <code>readr</code></strong></p>
<p>When reading in your data, you can use the <code>na</code> argument
inside <code>readr</code> to replace certain values with NA. For
example:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># not run</span></span>
<span><span class="va">dat_raw</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"original.csv"</span>, na <span class="op">=</span> <span class="va">na_strings</span><span class="op">)</span></span></code></pre></div>
<p>This would convert all of the values in <code>na_strings</code> into
missing values.</p>
<p>This is useful to use if you happen to know the NA types upon reading
in the data. However, this is not always practical in a data analysis
pipeline.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://njtierney.com/" class="external-link">Nicholas Tierney</a>, <a href="https://www.dicook.org/" class="external-link">Di Cook</a>, <a href="https://milesmcbain.xyz/" class="external-link">Miles McBain</a>, <a href="https://colinfay.me/" class="external-link">Colin Fay</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
